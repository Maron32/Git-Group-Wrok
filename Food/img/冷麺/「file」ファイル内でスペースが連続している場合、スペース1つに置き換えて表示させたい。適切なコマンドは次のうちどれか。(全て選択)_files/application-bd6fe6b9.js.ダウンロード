import{v as c,j as _,n as h,V as f,T as F,R as G}from"./bootstrap-0307c4b5.js";import{V as Q}from"./vue-disable-interpolation.common-41e3d90b.js";import{h as w,a as $,H as j,b as A}from"./accessibility-18562cce.js";import{q as C,D as R}from"./DeleteConfirmableButton-c15a8bb4.js";import{c as b,a as D,q,b as E,d as N,e as L,f as K}from"./index-4776dea0.js";import{q as V,a as T}from"./questoin-utils-79246cf6.js";import"./bootstrap-common-8aa40135.js";import"./_commonjsHelpers-042e6b4d.js";const O=async n=>{const{questionSubjectId:e}=n,{data:t}=await b.post(D({questionSubjectId:e}),n.payload);return t},U=c.defineComponent({props:{questionSubjectId:{type:Number,required:!0},isPremium:{type:Boolean,required:!0}},setup(n){const e=c.reactive({questionCount:0,pickup:!1,comboStatusChecks:[],favoriteGroupIds:[],favoriteGroupCondition:"any",practiceQuestionCounts:void 0,tagIds:[],questionLimit:"10",corporation:!1,branchSectionRefs:[]});c.onMounted(()=>{e.favoriteGroupIds.length&&_("#favoriteGroupForm").collapse()});const t=q(n.questionSubjectId,"practice"),s=o=>{e.branchSectionRefs.push(o)},r=()=>{const o=C(t),v=o.load(),{comboStatusChecks:m,pickup:k,favoriteGroupIds:g,favoriteGroupCondition:I,tagIds:x,questionLimit:P,corporation:B,isPremium:S}=v.base;if(S!==n.isPremium){o.remove(),e.comboStatusChecks=m;return}e.comboStatusChecks=m,e.pickup=k,e.favoriteGroupIds=g,e.favoriteGroupCondition=I,e.tagIds=x,e.questionLimit=P,e.corporation=B},u=()=>{const o={comboStatusChecks:e.comboStatusChecks,pickup:e.pickup,favoriteGroupIds:e.favoriteGroupIds,favoriteGroupCondition:e.favoriteGroupCondition,tagIds:e.tagIds,questionLimit:e.questionLimit,corporation:e.corporation,isPremium:n.isPremium},v=C(t),m=v.load();m.base=o,v.save(m)},i=async o=>{e.practiceQuestionCounts===void 0&&!o||(e.practiceQuestionCounts=await O({questionSubjectId:n.questionSubjectId,payload:{question_session:{mode:"practice",combo_statuses:e.comboStatusChecks,pickup:e.pickup,favorite_group_ids:e.favoriteGroupIds,favorite_group_condition:e.favoriteGroupCondition,tag_ids:e.tagIds,corporation:e.corporation}}}))},d=()=>{e.branchSectionRefs.forEach(o=>{o.handleSelect()})},l=()=>{e.branchSectionRefs.forEach(o=>{o.handleDeselect()})},p=o=>{e.questionCount+=o},a=()=>{i(),u()};return c.watch(()=>[e.comboStatusChecks,e.pickup,e.favoriteGroupIds,e.favoriteGroupCondition,e.tagIds,e.questionLimit,e.corporation],()=>a()),r(),i(!0),{state:e,handleAllBranchSelect:d,handleAllBranchDeselect:l,handleChangeQuestionCount:p,setBranchSectionRefs:s}}});var H=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",[e._t("default",null,{state:e.state,handleAllBranchSelect:e.handleAllBranchSelect,handleAllBranchDeselect:e.handleAllBranchDeselect,handleChangeQuestionCount:e.handleChangeQuestionCount,setBranchSectionRefs:e.setBranchSectionRefs})],2)},M=[],z=h(U,H,M,!1,null,null,null,null);const X=z.exports,J=c.defineComponent({props:{questionSubjectId:{type:Number,required:!0},questionBranchId:{type:Number,required:!0},questionBranchName:{type:String,required:!0},questionCount:{type:Number,default:0},premium:{type:Boolean,required:!0},premiumUser:{type:Boolean,required:!0}},setup(n,e){const t=c.reactive({checked:!1}),s=q(n.questionSubjectId,"practice"),r=n.premium&&!n.premiumUser,u=`question_session_question_branch_ids_${n.questionBranchId}`,i=a=>{t.checked=a},d=a=>{e.emit("change-question-count",a)},l=()=>{const a=C(s),o=a.load();o.checks[n.questionBranchId]=t.checked,a.save(o)};return(()=>{const o=C(s).load();t.checked=o.checks[n.questionBranchId]||!1})(),c.watch(()=>t.checked,()=>{l(),t.checked?d(+n.questionCount):d(-n.questionCount)}),c.watch(()=>n.questionCount,(a,o)=>{t.checked&&d(a-o)}),{state:t,disabled:r,checkboxIdentity:u,changeChecked:i}}});var W=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"form-check form-check-inline"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.state.checked,expression:"state.checked"}],staticClass:"form-check-input",attrs:{type:"checkbox",name:"question_session[question_branch_ids][]",disabled:e.disabled,id:e.checkboxIdentity},domProps:{value:e.questionBranchId,checked:Array.isArray(e.state.checked)?e._i(e.state.checked,e.questionBranchId)>-1:e.state.checked},on:{change:function(s){var r=e.state.checked,u=s.target,i=!!u.checked;if(Array.isArray(r)){var d=e.questionBranchId,l=e._i(r,d);u.checked?l<0&&e.$set(e.state,"checked",r.concat([d])):l>-1&&e.$set(e.state,"checked",r.slice(0,l).concat(r.slice(l+1)))}else e.$set(e.state,"checked",i)}}}),t("label",{staticClass:"form-check-label",attrs:{for:e.checkboxIdentity}},[t("span",{domProps:{textContent:e._s(e.questionBranchName)}})]),t("span",{staticClass:"input-text-muted",domProps:{textContent:e._s(e.questionCount)}}),e.premium?t("i",{staticClass:"far fa-parking fa-fw text-cyan"}):e._e()])},Y=[],Z=h(J,W,Y,!1,null,null,null,null);const y=Z.exports,ee=c.defineComponent({components:{QuestionBranchCheckBox:y},props:{questionBranches:{type:Array,required:!1},practiceQuestionCounts:{type:Array},name:{type:String,required:!0},premiumUser:{type:Boolean,required:!0},questionSubjectId:{type:Number,required:!0}},setup(n,e){const t=c.reactive({questionBranchCheckBoxRefs:[]}),s=p=>{t.questionBranchCheckBoxRefs.forEach(a=>{a.changeChecked(p)})};return{handleSelect:()=>{s(!0)},handleDeselect:()=>{s(!1)},handleChangeQuestionCount:p=>{e.emit("change-question-count",p)},branchQuestionCount:p=>{if(n.practiceQuestionCounts===void 0)return;const a=n.practiceQuestionCounts.find(o=>o.questionBranchId===p.id);return a?a.count:0},setQuestionBranchCheckBoxRefs:p=>{t.questionBranchCheckBoxRefs.push(p)}}}});var te=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"mb-4"},[t("div",{staticClass:"title-border-radius"},[t("p",{domProps:{textContent:e._s(e.name)}}),t("ul",{staticClass:"title-border-radius__btn"},[t("li",[t("a",{attrs:{href:"#"},on:{click:function(s){return s.stopPropagation(),s.preventDefault(),e.handleSelect.apply(null,arguments)}}},[e._v("選択")])]),t("li",[t("a",{attrs:{href:"#"},on:{click:function(s){return s.stopPropagation(),s.preventDefault(),e.handleDeselect.apply(null,arguments)}}},[e._v("解除")])])])]),t("div",{staticClass:"mb-4"},[t("div",{staticClass:"form-group string optional question_session_question_branch_ids"},e._l(e.questionBranches,function(s){return t("QuestionBranchCheckBox",{key:s.id,ref:e.setQuestionBranchCheckBoxRefs,refInFor:!0,attrs:{"practice-question-counts":e.practiceQuestionCounts,"question-count":e.branchQuestionCount(s),"question-subject-id":e.questionSubjectId,"question-branch-id":s.id,"question-branch-name":s.name,premium:s.premium,"premium-user":e.premiumUser},on:{"change-question-count":e.handleChangeQuestionCount}})}),1)])])},ne=[],se=h(ee,te,ne,!1,null,null,null,null);const oe=se.exports,ae=n=>`00${n}`.slice(-2),re=n=>{let e=parseInt(n.dataset.second,10);if(e=e<=0?0:e-1,e===0){window.location.href=n.dataset.abortUrl;return}const t=Math.floor(e/60),s=ae(e%60);n.textContent=`${t}:${s}`,n.dataset.second=e.toString(),e<=parseInt(n.dataset.threshold,10)&&document.getElementById("js-question-session-remain-bar").classList.add("bg-danger")},ie=()=>{const n=document.getElementsByClassName("js-adjust-iframe");Array.from(n).forEach(e=>E(e,40))},ce=()=>{Array.from(document.querySelectorAll("#js-question-selections input")).filter(n=>n.dataset.correct==="true").map(n=>Array.from(n.parentElement.getElementsByTagName("label"))).flat().forEach(n=>{n.classList.add("text-info","font-weight-bold","correct-image-border")})},ue=()=>{document.getElementsByClassName("js-cannot-back").length>0&&window.history.forward();const n=document.getElementById("js-question-session-remain-second");n&&setInterval(()=>{re(n)},1e3),_(".js-iframe-collapse").on("shown.bs.collapse",ie),_(".js-question-session-correct-collapse").on("show.bs.collapse",ce)},de=c.defineComponent({props:{questionData:{type:Object,required:!0},favoriteGroupsData:{type:Array,required:!0}},setup(n){c.onMounted(()=>{ue()});const e=c.reactive({question:n.questionData,favoriteGroups:n.favoriteGroupsData}),t=(u,i)=>{const d=e.favoriteGroups.find(l=>l.id===u);d!==void 0&&(d.favoriteId=i)};return{state:e,handleAddFavorite:(u,i)=>{t(u,i)},handleRemoveFavorite:u=>{t(u,null)}}}});var le=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",[e._t("default",null,{state:e.state,handleAddFavorite:e.handleAddFavorite,handleRemoveFavorite:e.handleRemoveFavorite})],2)},pe=[],fe=h(de,le,pe,!1,null,null,null,null);const he=fe.exports,me=async n=>{const{favoriteGroupId:e}=n,{data:t}=await b.post(N({favoriteGroupId:e}),{question_id:n.questionId});return t},ve=async n=>{const{favoriteGroupId:e,favoriteId:t}=n;await b.delete(L({favoriteGroupId:e,id:t}))},_e=c.defineComponent({props:{favoriteGroup:{type:Object,required:!0},question:{type:Object,required:!0},index:{type:Number,required:!0}},setup(n,e){const t=c.reactive({checked:n.favoriteGroup.favoriteId!=null,...n.favoriteGroup}),s=i=>{switch(i){case 1:return"q";case 2:return"w";case 3:return"r";default:return""}};return{state:t,accessKey:s,accessKeyText:i=>`(${s(i)})`,handleChange:async()=>{if(t.checked){const{id:i}=await me({favoriteGroupId:t.id,questionId:n.question.id});t.favoriteId=i,e.emit("add-favorite",t.id,t.favoriteId)}else await ve({favoriteGroupId:t.id,favoriteId:t.favoriteId}),e.emit("remove-favorite",t.id)}}}});var Ce=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"form-check"},[t("span",{staticClass:"accesskey",domProps:{textContent:e._s(e.accessKeyText(e.index))}}),t("input",{directives:[{name:"model",rawName:"v-model",value:e.state.checked,expression:"state.checked"}],staticClass:"form-check-input",attrs:{id:`favorite-group-checkbox-${e.state.id}`,type:"checkbox"},domProps:{checked:Array.isArray(e.state.checked)?e._i(e.state.checked,null)>-1:e.state.checked},on:{change:[function(s){var r=e.state.checked,u=s.target,i=!!u.checked;if(Array.isArray(r)){var d=null,l=e._i(r,d);u.checked?l<0&&e.$set(e.state,"checked",r.concat([d])):l>-1&&e.$set(e.state,"checked",r.slice(0,l).concat(r.slice(l+1)))}else e.$set(e.state,"checked",i)},e.handleChange]}}),t("label",{staticClass:"form-check-label",attrs:{for:`favorite-group-checkbox-${e.state.id}`,accesskey:e.accessKey(e.index)}},[t("span",{domProps:{textContent:e._s(e.state.title)}})])])},be=[],qe=h(_e,Ce,be,!1,null,null,null,null);const ye=qe.exports,ke=c.defineComponent({props:{favoriteGroups:{type:Array,required:!0}},setup(n){return{inFavoriteGroups:c.computed(()=>n.favoriteGroups.filter(t=>t.favoriteId!=null))}}});var ge=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"favorite-group-list"},e._l(e.inFavoriteGroups,function(s,r){return t("span",{key:r,staticClass:"badge badge-info ml-2",domProps:{textContent:e._s(s.title)}})}),0)},Ie=[],xe=h(ke,ge,Ie,!1,null,null,null,null);const Pe=xe.exports,Be=c.defineComponent({props:{favoriteGroupsData:{type:Array,required:!0}},setup(n){return{hasFavorite:c.computed(()=>n.favoriteGroupsData.some(t=>t.favoriteId!==null))}}});var Se=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("button",{staticClass:"btn btn-circle",class:{"btn-danger":e.hasFavorite,"btn-outline-secondary":!e.hasFavorite},attrs:{id:"favorite-groups-popover",type:"button",accesskey:"c","data-toggle":"popover","data-container":"body","data-placement":"top","data-html":"true"}},[t("i",{staticClass:"far fa-star fa-fw"}),t("span",[e._v("お気に入り")]),t("span",{staticClass:"accesskey"},[e._v("(c)")])])},Fe=[],Ge=h(Be,Se,Fe,!1,null,null,null,null);const Qe=Ge.exports,we=c.defineComponent({props:{questionSubjectId:{type:Number,required:!0},currentQuestionId:{type:Number,required:!0},returnPath:{type:String,default:void 0}},setup(n){const{questionSubjectId:e,currentQuestionId:t,returnPath:s}=n,r=p=>{if(p==null)return;let a={questionSubjectId:e,id:p};return s&&(a={...a,return:s}),K(a)},u=()=>{const p=T(e),a=V(p).load();if(a){const o=a.indexOf(t),v=r(a[o-1]),m=r(a[o+1]);return{prevPath:v,nextPath:m}}return{prevPath:void 0,nextPath:void 0}},{prevPath:i,nextPath:d}=u();return{state:c.reactive({prevPath:i,nextPath:d,returnPath:s})}}});var $e=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("nav",{staticClass:"footer-mondai__center footer-mondai__center--right"},[t("ul",{staticClass:"list-inline"},[e.state.prevPath?t("li",{staticClass:"list-inline-item"},[t("a",{staticClass:"btn btn-circle btn-info",attrs:{href:e.state.prevPath}},[t("i",{staticClass:"fa fa-arrow-left fa-fw"}),t("span",[e._v("前の問題")])])]):e._e(),e.state.returnPath?t("li",{staticClass:"list-inline-item"},[t("a",{staticClass:"btn btn-link-gray",attrs:{href:e.state.returnPath}},[e._v(" 一覧 ")])]):e._e(),e.state.nextPath?t("li",{staticClass:"list-inline-item"},[t("a",{staticClass:"btn btn-circle btn-info",attrs:{href:e.state.nextPath}},[t("i",{staticClass:"fa fa-arrow-right fa-fw"}),t("span",[e._v("次の問題")])])]):e._e()])])},je=[],Ae=h(we,$e,je,!1,null,null,null,null);const Re=Ae.exports;window.Bugsnag.getPlugin("vue").installVueErrorHandler(f);w.setOptions({credits:{enabled:!1}});$(j);f.use(Q);f.use(A);function De(){document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("[data-vue-app]").forEach(n=>{new f({el:n})})}),f.component("QuestionSubjectPracticeForm",X),f.component("QuestionBranchCheckBox",y),f.component("BranchSection",oe),f.component("QuestionContainer",he),f.component("FavoriteGroupCheckbox",ye),f.component("FavoriteGroupList",Pe),f.component("FavoriteButton",Qe),f.component("DeleteConfirmableButton",R),f.component("QuestionNavigation",Re),f.component("XToastr",F)}window.jQuery=_;window._rails_loaded||G.start();De();
//# sourceMappingURL=application-bd6fe6b9.js.map
